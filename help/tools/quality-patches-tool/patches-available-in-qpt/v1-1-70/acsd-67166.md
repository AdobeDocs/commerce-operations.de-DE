---
title: 'ACSD-67166: Doppelte Ausführung der Abfrage „CATALOGINVENTURE_STOCK_STATUS“ beim Laden eines Angebots in die Storefront'
description: Wenden Sie den Patch ACSD-67166 an, um das Adobe Commerce-Problem zu beheben, bei dem die doppelte Ausführung der Abfrage „CATALOGINVENTURE_STOCK_STATUS“ beim Laden eines Angebots in die Storefront auftritt, was zu redundanten DB-Aufrufen führt.
feature: Inventory
role: Admin, Developer
type: Troubleshooting
source-git-commit: ef596770b58528f9dddb4bd1650d7cbed0bf0b95
workflow-type: tm+mt
source-wordcount: '344'
ht-degree: 0%

---


# ACSD-67166: Doppelte Ausführung der `cataloginventory_stock_status` Abfrage beim Laden eines Angebots in der Storefront

Mit dem Patch ACSD-67166 wird das Problem behoben, dass beim Laden eines Angebots in der Storefront eine doppelte Ausführung der `cataloginventory_stock_status`-Abfrage auftritt, was zu redundanten DB-Aufrufen führt. Dieser Patch ist verfügbar, wenn [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.70 installiert ist. Die Patch-ID ist ACSD-67166. Dieses Problem wird voraussichtlich in Adobe Commerce 2.4.9 behoben.

## Betroffene Produkte und Versionen

**Der Patch wird für die Adobe Commerce-Version erstellt:**

* Adobe Commerce (alle Bereitstellungsmethoden) 2.4.5-p13

**Kompatibel mit Adobe Commerce-Versionen:**

* Adobe Commerce (alle Bereitstellungsmethoden) 2.4.4 - 2.4.8-p2

>[!NOTE]
>
>Der Patch könnte mit neuen [!DNL Quality Patches Tool]-Versionen auch für andere Versionen gelten. Um zu überprüfen, ob der Patch mit Ihrer Adobe Commerce-Version kompatibel ist, aktualisieren Sie das `magento/quality-patches` auf die neueste Version und überprüfen Sie die Kompatibilität auf der Seite [[!DNL Quality Patches Tool]: Nach Patches suchen](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html). Verwenden Sie die Patch-ID als Suchbegriff, um den Patch zu finden.

## Problem

Beim Laden eines Angebots in die Storefront kommt es zu einer doppelten Ausführung der `cataloginventory_stock_status`-Abfrage, was zu redundanten DB-Aufrufen führt.

<u>Schritte zur Reproduktion</u>:

1. Installieren Sie eine neue Instanz.
1. Erstellen Sie eine **[!UICONTROL Category]** und eine **[!UICONTROL Simple Product]**.
1. Gehen Sie zur Kategorie und fügen Sie ein Produkt zum Warenkorb hinzu.
1. Navigieren Sie zur Warenkorbseite: `/checkout/cart/`
1. Festlegen von Haltepunkten in [!DNL xDebug]:
   1. `app/code/Magento/CatalogInventory/Model/StockRegistryPreloader.php:115`
   1. `app/code/Magento/InventoryCatalog/Model/LegacyStockStatusCache.php:73`
   1. `lib/internal/Magento/Framework/Data/AbstractSearchResult.php:233`
   1. **Breakpoint-Bedingung**: `strpos($this->query->getSelectSql(true), 'stock_status') !==false`
Fügen Sie `$_SERVER['REQUEST_URI']` zu *watches* hinzu, [!DNL PHPStorm] zu überprüfen, ob die Abfrage innerhalb derselben Anfrage zweimal aufgerufen wird.

<u>Erwartete Ergebnisse</u>:

Die Abfrage wird einmal pro Anfrage ausgeführt.

<u>Tatsächliche Ergebnisse</u>:

Dieselbe Abfrage wird zweimal ausgeführt:

```
SELECT `main_table`.*, `cp_table`.`sku`, `cp_table`.`type_id` FROM `cataloginventory_stock_status` AS `main_table`
 INNER JOIN `catalog_product_entity` AS `cp_table` ON main_table.product_id = cp_table.entity_id AND (cp_table.created_in <= 1 AND cp_table.updated_in > 1) WHERE (`main_table`.`product_id` IN(2)) AND (`main_table`.`website_id` = '0') 
```

## Patch anwenden

Verwenden Sie je nach Bereitstellungsmethode die folgenden Links, um einzelne Patches anzuwenden:

* Adobe Commerce oder Magento Open Source On-Premise: [[!DNL Quality Patches Tool] > ](/help/tools/quality-patches-tool/usage.md) im [!DNL Quality Patches Tool]
* Adobe Commerce in Cloud-Infrastruktur: [Upgrades und Patches > Patches anwenden](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html) im Handbuch zu Commerce in Cloud-Infrastruktur

## Verwandtes Lesen

Weitere Informationen zu [!DNL Quality Patches Tool] finden Sie unter:

* [[!DNL Quality Patches Tool]: Ein Self-Service-Tool für hochwertige Patches](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) im Tools-Handbuch
